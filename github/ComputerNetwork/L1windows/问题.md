设计server 的主循环

遇到一个问题,a) 主线程还负责检测退出指令（如用户按退出键或者收到退出信号），检测到后即通知并等待各子线程退出。最后关闭Socket，主程序退出。

使用join可以让main强制等待所有创建的子线程退出后才结束,而如何在一直accept的主循环中检测到用户的中断信号从而终止服务器呢?

使用SIGINT 在main开始时设置一个信号检测到中断之后,设置全局变量ServerRunning=false,这样就实现了CtrlC结束服务器的功能,而且使用全局变量来提醒所有子进程退出

但是还是有点问题,最后我了解到使用全局变量进行通信存在问题,应该使用CPP的atomic量来实现这一点



客户端接收消息是产销模型,服务器发一个包 对应生产者,Client接受并处理对应消费一次.

我现在有这样一个模型,客户端发送信息给服务器,主线程负责和用户进行IO交互,而当链接服务器成功以后,会创建一个负责接受消息的子进程,这个子进程应该负责循环调用recv函数接受服务器发来的消息,并在处理完消息之后将结果反馈给main线程,这需要用到线程通信

这里采取模拟的方式 ,因为在windows下消息队列比较难用,而且不支持管道操作,只能使用notify函数来告诉父进程去访问全局变量



Client没能成功发包 